# 综合配置文件说明

## 🎯 配置重构总结

已将原来仅包含MySQL配置的单一文件重命名为综合配置文件，并扩展了配置结构：

### ✅ 已完成的重构
- 将 `database-config.js` 重命名为 `config.js` 
- 扩展为包含应用、数据库、服务器、安全、日志等多维度配置
- 所有相关文件已更新引用路径

### ✅ 新的综合配置文件
- `config.js` - 包含应用、数据库、服务器、安全、日志等综合配置

## 📁 文件结构

```
e:\Trae\navi\
├── config.js            # 综合配置文件（包含应用、数据库、服务器等配置）
├── db-test.js           # 数据库连接测试脚本
├── db-init.js           # 数据库初始化脚本
├── package.json         # 项目配置
└── ...其他文件
```

## 🔧 综合配置文件说明

### `config.js` 综合配置文件包含内容：

1. **应用基本信息**
   - 名称、版本、描述

2. **数据库配置**
   - 开发环境配置
   - 生产环境配置
   - 测试环境配置
   - 数据库表结构定义
   - 连接字符串
   - 初始化SQL
   - 工具函数（获取当前配置、创建连接池、测试连接）

3. **服务器配置**
   - 端口、主机等设置

4. **安全配置**
   - 安全头部设置
   - 速率限制配置

5. **日志配置**
   - 日志级别设置
   - 输出格式配置

6. **缓存配置**
   - Redis配置（预留）
   - 内存缓存配置

## 🚀 使用方法

### 1. 安装依赖
```bash
npm install mysql2
```

### 2. 修改配置文件

编辑 `config.js` 文件，根据你的需求修改配置：

```javascript
// 修改数据库配置
database: {
  mysql: {
    development: {
      host: 'localhost',
      user: 'your_username',
      password: 'your_password',
      database: 'navi',
      port: 3306
    }
  }
}

// 修改服务器配置
server: {
  port: 8000,
  host: 'localhost'
}
```

### 3. 测试数据库连接
```bash
node db-test.js
```

### 4. 显示配置摘要
```bash
node db-test.js --summary
```

### 5. 显示数据库表结构
```bash
node db-test.js --schema
```

### 6. 显示初始化SQL
```bash
node db-test.js --sql
```

### 7. 初始化数据库
```bash
node db-init.js
```

### 8. 重置数据库（谨慎使用）
```bash
node db-init.js --reset
```

### 9. 检查数据库状态
```bash
node db-init.js --status
```

## 📊 数据库配置信息

### 连接信息
- **主机**: 192.168.100.193
- **端口**: 33310
- **数据库**: navi
- **用户名**: navi
- **密码**: qwer123

### 支持的环境
- **development** - 开发环境
- **production** - 生产环境
- **test** - 测试环境

## 🎯 使用示例代码

### 在代码中使用综合配置

```javascript
const config = require('./config');

// 获取当前数据库配置
const dbConfig = config.utils.getDatabaseConfig();

// 获取当前环境
const env = config.utils.getCurrentEnv();

// 获取连接字符串
const connectionString = config.utils.getConnectionString();

// 使用配置
const connection = await mysql.createConnection({
  host: dbConfig.host,
  user: dbConfig.user,
  password: dbConfig.password,
  database: dbConfig.database,
  port: dbConfig.port
});
```

### 环境变量控制
```bash
# 设置环境
set NODE_ENV=production
node db-test.js
```

## 🔄 后续维护

- 所有配置修改只需在 `config.js` 中进行
- 新增数据库环境只需在 `config.js` 中添加相应配置
- 修改表结构只需更新 `database.tables` 配置部分
- 新增初始化SQL只需更新 `database.initSQL` 部分
- 新增服务器配置只需更新 `server` 配置部分
- 可扩展更多配置模块（如缓存、消息队列等）

## 📋 优势

1. **综合配置** - 不仅限于数据库，包含应用、服务器、安全等全方位配置
2. **集中管理** - 所有配置在一个文件中
3. **环境分离** - 支持多环境配置
4. **易于维护** - 修改配置只需改动一个文件
5. **功能丰富** - 包含测试、初始化、重置等功能
6. **文档完整** - 提供详细的使用说明
7. **扩展性强** - 支持未来添加更多配置模块